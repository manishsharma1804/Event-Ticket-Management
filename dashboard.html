<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EventTix - Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.4.4/build/qrcode.min.js"></script>
    <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <!-- Add this in the head section, before your existing styles -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 0;
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f0f2f5;
        }

        .navbar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 0.8rem 1.5rem; /* Reduced padding */
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .navbar h1 {
            font-size: 1.2rem; /* Slightly smaller font */
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 8px;
            padding-right: 1rem;
            border-right: 1px solid rgba(255, 255, 255, 0.2);
        }

        .user-profile i {
            font-size: 1.4rem;
            color: rgba(255, 255, 255, 0.9);
        }

        .user-details {
            display: flex;
            flex-direction: column;
            line-height: 1.1;
        }

        .user-name {
            font-size: 0.7rem;
            color: rgba(255, 255, 255, 0.8);
        }

        .user-email {
            font-size: 0.8rem;
            color: white;
        }

        .logout-btn {
            background: transparent;
            border: 2px solid white;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .logout-btn:hover {
            background: white;
            color: #667eea;
        }

        /* Update container styles */
        .container {
            max-width: none;
            min-height: calc(100vh - 60px - 400px); /* Subtract navbar and footer heights */
            margin: 1rem auto;
            padding: 0 1rem;
            position: relative;
            z-index: 1;
        }

        .events-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        /* Update the event card styles */
        .event-card {
            position: relative;
            height: 500px; /* Fixed height for the card */
            display: flex;
            flex-direction: column;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .event-card img {
            width: 100%;
            height: 200px; /* Fixed height for image */
            object-fit: cover;
        }

        .event-content {
            display: flex;
            flex-direction: column;
            flex: 1;
            padding: 1rem;
            position: relative;
            padding-bottom: 70px; /* Space for the button */
            min-height: 200px; /* Add minimum height */
        }

        .event-details {
            flex: 1;
            overflow: hidden;
            margin-bottom: 1rem; /* Add space between content and button */
        }

        .event-details h3 {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            color: #333;
        }

        .event-details p {
            color: #666;
            margin-bottom: 0.5rem;
        }

        /* Position the button at the bottom */
        .book-btn {
            position: absolute;
            bottom: 1rem;
            left: 1rem;
            right: 1rem;
            width: calc(100% - 2rem);
            padding: 0.8rem;
            background: #3B82F6;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
            z-index: 1; /* Add this to ensure button stays on top */
        }

        .book-btn:hover {
            background: #2563EB;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .event-card {
                height: auto;
                min-height: 450px;
            }

            .event-content {
                padding-bottom: 60px;
            }
        }

        .event-card:hover {
            transform: translateY(-5px);
        }

        .event-card h3 {
            color: #4a5568;
            margin-bottom: 0.5rem;
        }

        .event-card p {
            color: #718096;
            margin-bottom: 1rem;
        }

        .book-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            font-size: 1rem;
            transition: background 0.3s;
        }

        .book-btn:hover {
            background: #5a67d8;
        }

        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            overflow-y: auto;
        }

        .modal-content {
            background: white;
            margin: 2rem auto;
            padding: 2rem;
            border-radius: 10px;
            max-width: 800px;
            width: 90%;
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        .close {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            color: #000;
            background: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.5rem;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .close:hover {
            background: #f3f4f6;
            transform: scale(1.1);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #e2e8f0;
            border-radius: 5px;
            font-size: 1rem;
        }

        #qrcode {
            text-align: center;
            margin: 1.5rem 0;
        }

        #ticketDetails {
            background: #f7fafc;
            padding: 1rem;
            border-radius: 5px;
            margin: 1rem 0;
        }

        .success-message {
            text-align: center;
            padding: 2rem;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-radius: 50%;
            border-top: 3px solid #667eea;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .my-tickets-btn {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            margin-left: 1rem;
        }

        .my-tickets-btn:hover {
            background: #667eea;
            color: white;
        }

        /* Add these new styles */
        .event-card {
            height: 450px; /* Fixed height */
            display: flex;
            flex-direction: column;
        }

        .event-card img {
            height: 200px;
            width: 100%;
            object-fit: cover;
        }

        .event-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .event-details {
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
        }

        /* Add loading animation */
        .payment-processing {
            text-align: center;
            padding: 2rem;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .payment-loader {
            border: 5px solid #f3f3f3;
            border-radius: 50%;
            border-top: 5px solid #667eea;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        .event-images {
            display: flex;
            overflow-x: auto;
            gap: 10px;
            margin-bottom: 20px;
            padding: 10px 0;
            -webkit-overflow-scrolling: touch;
        }
        .event-images img {
            width: 200px;
            height: 150px;
            object-fit: cover;
            border-radius: 8px;
            flex-shrink: 0;
        }
        .event-full-details {
            padding: 20px;
            overflow-y: auto;
        }
        .event-full-details h2 {
            margin-bottom: 15px;
            color: #4a5568;
        }
        .event-full-details p {
            margin-bottom: 10px;
            color: #718096;
        }
        .book-tickets-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 20px;
            width: 100%;
        }
        .book-tickets-btn:hover {
            background: #5a67d8;
        }

        /* Additional responsive styles */
        @media (max-width: 768px) {
            .modal-content {
                margin: 1rem;
                width: calc(100% - 2rem);
                padding: 1rem;
            }

            .event-images img {
                width: 150px;
                height: 100px;
            }
        }

        /* Style updates for sections within modal */
        #eventFullDetails,
        #ticketSelection,
        #paymentDetails,
        #successSection {
            width: 100%;
        }

        .booking-status {
            padding: 8px 12px;
            border-radius: 4px;
            margin: 8px 0;
            font-size: 0.9rem;
        }

        .booking-status.warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
        }

        .booking-status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .book-btn:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            opacity: 0.7;
        }

        .tickets-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2rem;
            max-width: 600px;
            margin: 0 auto;
        }

        .ticket-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 15px;
            overflow: hidden;
            transition: transform 0.2s ease;
        }

        .ticket-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .ticket-header {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            padding: 12px 15px;
            position: relative;
        }

        .ticket-title {
            font-size: 16px;
            font-weight: 600;
            margin: 0;
            padding-right: 35px;
        }

        .ticket-date {
            font-size: 14px;
            opacity: 0.9;
            margin-top: 4px;
        }

        .ticket-content {
            padding: 15px;
        }

        .ticket-details {
            width: 100%;
        }

        .ticket-info {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .info-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .info-item:last-child {
            border-bottom: none;
        }

        .info-label {
            color: #6b7280;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .info-label i {
            color: #6366f1;
            width: 16px;
            text-align: center;
        }

        .info-value {
            color: #1a202c;
            font-size: 14px;
            font-weight: 500;
        }

        .info-value.highlight {
            color: #6366f1;
            font-size: 15px;
            font-weight: 600;
        }

        .ticket-actions {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e5e7eb;
        }

        .download-btn {
            width: 40px;
            height: 40px;
            background: #6366f1;
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: auto;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .download-btn i {
            font-size: 1.2rem;
        }

        .download-btn:hover {
            background: #4f46e5;
            transform: translateY(-2px);
        }

        /* Modal Responsive Styles */
        @media (max-width: 768px) {
            .modal-content {
                width: 95%;
                margin: 10px;
                max-height: 90vh;
            }

            #eventFullDetails {
                padding: 15px;
            }

            .ticket-download {
                transform: scale(0.8);
                transform-origin: top center;
            }
        }

        .ticket-type-selection {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .book-tickets-btn {
            padding: 8px 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .book-tickets-btn:hover {
            background-color: #45a049;
        }

        .event-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .event-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }

        .event-badge.venue {
            background-color: #4CAF50;
            color: white;
        }

        .event-badge.online {
            background-color: #2196F3;
            color: white;
        }

        .event-badge.hybrid {
            background-color: #9C27B0;
            color: white;
        }

        .ticket-type-selection {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .book-tickets-btn {
            padding: 8px 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            flex: 1;
            min-width: 150px;
        }

        .book-tickets-btn:hover {
            background-color: #45a049;
        }

        .book-tickets-btn.online {
            background-color: #2196F3;
        }

        .book-tickets-btn.online:hover {
            background-color: #1976D2;
        }

        .status-badge {
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 14px;
            font-weight: bold;
            margin-left: 10px;
        }

        .status-badge.live {
            background-color: #4CAF50;
            color: white;
        }

        .status-badge.upcoming {
            background-color: #2196F3;
            color: white;
        }

        .status-badge.closed {
            background-color: #f44336;
            color: white;
        }

        .status-badge.sold-out {
            background-color: #ff9800;
            color: white;
        }

        /* Payment Page Styles */
        .payment-details {
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .payment-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .payment-form input {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .payment-btn {
            background-color: #4CAF50;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }

        .payment-btn:hover {
            background-color: #45a049;
        }

        .payment-processing {
            text-align: center;
            padding: 20px;
        }

        .payment-loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Event Details Modal Styles */
        .event-full-details {
            padding: 20px;
        }

        .event-images-carousel {
            width: 100%;
            height: 300px;
            overflow: hidden;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .event-detail-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .event-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .event-header h2 {
            margin: 0;
            color: #333;
        }

        .event-info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .event-info-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
        }

        .event-info-section h3 {
            margin-top: 0;
            color: #444;
            border-bottom: 2px solid #ddd;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }

        .info-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .info-item i {
            width: 20px;
            margin-right: 10px;
            color: #666;
        }

        .ticket-info {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .price-tag {
            background: white;
            padding: 15px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            border: 1px solid #e0e0e0;
            margin-bottom: 10px;
        }

        .price-tag.inactive {
            opacity: 0.8;
            background: #f5f5f5;
        }

        .price-details {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .price {
            font-size: 1.2em;
            color: #2196F3;
            font-weight: 600;
        }

        .available-count {
            font-size: 0.9em;
            color: #666;
            background: #f8f9fa;
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: 500;
        }

        .event-description {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .booking-actions {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .book-tickets-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .book-tickets-btn.venue {
            background: #4CAF50;
            color: white;
        }

        .book-tickets-btn.online {
            background: #2196F3;
            color: white;
        }

        .book-tickets-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 500;
        }

        .status-badge.live {
            background: #4CAF50;
            color: white;
        }

        .status-badge.upcoming {
            background: #FFC107;
            color: #333;
        }

        .status-badge.closed {
            background: #F44336;
            color: white;
        }

        .status-badge.sold-out {
            background: #9E9E9E;
            color: white;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .event-info-grid {
                grid-template-columns: 1fr;
            }

            .event-images-carousel {
                height: 200px;
            }

            .booking-actions {
                flex-direction: column;
            }
        }

        .booking-time-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border: 1px solid #e0e0e0;
        }

        .booking-time-info p {
            margin: 8px 0;
            color: #444;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .booking-time-info i {
            color: #2196F3;
            width: 20px;
            text-align: center;
        }

        .status-badge.upcoming {
            background: #2196F3;
            color: white;
        }

        /* Update existing status badge styles */
        .status-badge {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .status-badge::before {
            content: '';
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: currentColor;
            display: inline-block;
        }

        .available-count.sold {
            color: white;
            background: #dc3545;
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: 500;
        }

        .available-count.upcoming {
            color: #2196F3;
            background: #e3f2fd;
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: 500;
        }

        .event-status-container {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 2;
        }

        .event-card {
            position: relative;
        }

        .status-badge {
            padding: 8px 16px;
            border-radius: 4px;
            font-size: 0.85em;
            font-weight: bold;
            letter-spacing: 0.5px;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .status-badge.live {
            background: #4CAF50;
            color: white;
        }

        .status-badge.upcoming {
            background: #2196F3;
            color: white;
        }

        .status-badge.closed {
            background: #F44336;
            color: white;
        }

        .status-badge.sold-out {
            background: #FF9800;
            color: white;
        }

        .tickets-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid #eee;
        }

        .archive-btn, .back-btn {
            padding: 8px 16px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .archive-btn:hover, .back-btn:hover {
            background: #5a67d8;
        }

        .ticket-status.expired {
            background: #dc2626;
        }

        .download-ticket-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .download-ticket-btn:hover {
            background: #5a67d8;
            transform: translateY(-2px);
        }

        .ticket-details {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .ticket-details p {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .ticket-details i {
            color: #667eea;
            width: 20px;
        }

        .download-ticket-btn:disabled {
            background-color: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .ticket-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 15px;
            overflow: hidden;
            transition: transform 0.2s ease;
        }

        .ticket-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .ticket-header {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            padding: 12px 15px;
            position: relative;
        }

        .ticket-title {
            font-size: 16px;
            font-weight: 600;
            margin: 0;
            padding-right: 35px;
        }

        .ticket-date {
            font-size: 14px;
            opacity: 0.9;
            margin-top: 4px;
        }

        .ticket-content {
            padding: 15px;
        }

        .ticket-details {
            width: 100%;
        }

        .ticket-info {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .info-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .info-item:last-child {
            border-bottom: none;
        }

        .info-label {
            color: #6b7280;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .info-label i {
            color: #6366f1;
            width: 16px;
            text-align: center;
        }

        .info-value {
            color: #1a202c;
            font-size: 14px;
            font-weight: 500;
        }

        .info-value.highlight {
            color: #6366f1;
            font-size: 15px;
            font-weight: 600;
        }

        .ticket-actions {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e5e7eb;
        }

        .download-btn {
            width: 40px;
            height: 40px;
            background: #6366f1;
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: auto;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .download-btn i {
            font-size: 1.2rem;
        }

        .download-btn:hover {
            background: #4f46e5;
            transform: translateY(-2px);
        }

        /* Mobile Styles */
        @media (max-width: 768px) {
            .ticket-card {
                border-radius: 8px;
            }

            .ticket-header {
                padding: 12px 15px;
            }

            .ticket-title {
                font-size: 16px;
                padding-right: 35px;
            }

            .ticket-content {
                padding: 15px;
                flex-direction: column;
                align-items: flex-start;
            }

            .ticket-info {
                grid-template-columns: 1fr;
                gap: 10px;
                width: 100%;
            }

            .info-item {
                flex-direction: row;
                align-items: center;
                justify-content: space-between;
            }

            .info-label {
                font-size: 12px;
                margin-bottom: 0;
            }

            .info-value {
                font-size: 14px;
            }

            .ticket-actions {
                margin-left: 0;
                margin-top: 15px;
                width: 100%;
            }

            .download-btn {
                width: 100%;
                justify-content: center;
                padding: 12px;
            }

            .download-btn span {
                display: none;
            }
        }

        .ticket-download-template {
            position: fixed;
            left: -9999px;
            top: -9999px;
        }

        .ticket-download {
            width: 800px;
            min-height: 600px;
            padding: 30px;
            background: white;
            border: 10px solid;
            border-image: linear-gradient(45deg, #667eea, #764ba2) 1;
            font-family: 'Arial', sans-serif;
            position: relative;
        }

        .header-content {
            text-align: center;
            padding-bottom: 20px;
            border-bottom: 2px solid #667eea;
        }

        .logo-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .ticket-type-badge {
            background: #667eea;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
        }

        .ticket-serial {
            color: #64748b;
            font-size: 14px;
            font-weight: 600;
        }

        .qr-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .verification-text {
            text-align: center;
            font-size: 12px;
            color: #64748b;
        }

        .terms-section {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 15px;
        }

        .restrictions {
            font-size: 10px;
            color: #64748b;
            border-left: 1px solid #e2e8f0;
            padding-left: 20px;
        }

        .restrictions p {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .restrictions ul {
            margin: 0;
            padding-left: 15px;
        }

        .footer-info {
            text-align: center;
            border-top: 1px dashed #cbd5e1;
            padding-top: 10px;
            margin-top: 10px;
        }

        .copyright {
            font-size: 10px;
            color: #94a3b8;
            margin-top: 5px;
        }

        .ticket-download::before,
        .ticket-download::after {
            content: '';
            position: absolute;
            width: 40px;
            height: 40px;
            background: #fff;
            border-radius: 50%;
            top: 50%;
            transform: translateY(-50%);
        }

        .ticket-download::before {
            left: -30px;
        }

        .ticket-download::after {
            right: -30px;
        }

        .tix-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            padding: 20px;
        }

        .tix-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }

        .tix-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
        }

        .tix-past {
            opacity: 0.7;
        }

        .tix-header {
            padding: 15px;
            background: linear-gradient(135deg, #1a237e, #0d47a1);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .tix-event-name {
            font-size: 1.2em;
            font-weight: 600;
            flex: 1;
            margin-right: 10px;
        }

        .tix-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: 500;
        }

        .tix-status-valid {
            background: #4caf50;
            color: white;
        }

        .tix-status-used {
            background: #f44336;
            color: white;
        }

        .tix-status-past {
            background: #9e9e9e;
            color: white;
        }

        .tix-body {
            padding: 15px;
        }

        .tix-info {
            display: grid;
            gap: 10px;
        }

        .tix-detail {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #666;
        }

        .tix-detail i {
            width: 20px;
            color: #1a237e;
        }

        .tix-price {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .tix-price-label {
            color: #666;
            font-size: 0.9em;
        }

        .tix-price-value {
            font-size: 1.2em;
            font-weight: 600;
            color: #1a237e;
        }

        .tix-footer {
            padding: 15px;
            background: #f8f9fa;
            display: flex;
            gap: 10px;
        }

        .tix-view-btn, .tix-join-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: background-color 0.2s;
        }

        .tix-view-btn {
            background: #1a237e;
            color: white;
        }

        .tix-view-btn:hover {
            background: #0d47a1;
        }

        .tix-join-btn {
            background: #4caf50;
            color: white;
        }

        .tix-join-btn:hover {
            background: #45a049;
        }

        @media (max-width: 768px) {
            .tix-container {
                grid-template-columns: 1fr;
                padding: 10px;
            }
        }

        .home-btn {
            padding: 8px 16px;
            background: #3B82F6;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            margin-right: 10px;
            transition: background 0.3s ease;
        }

        .home-btn:hover {
            background: #2563EB;
        }

        .home-btn i {
            font-size: 16px;
        }

        /* Responsive Styles */
        @media (max-width: 1200px) {
            .container {
                padding: 0 1rem;
            }

            .events-grid {
                gap: 1.5rem;
            }
        }

        @media (max-width: 992px) {
            .events-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .modal-content {
                width: 90%;
                margin: 2rem auto;
            }
        }

        @media (max-width: 768px) {
            .navbar {
                padding: 0.6rem 1rem; /* Even smaller padding on mobile */
            }

            .user-profile {
                padding-right: 0.8rem;
                gap: 6px;
            }

            .user-profile i {
                font-size: 1.2rem;
            }

            .user-details {
                max-width: 120px; /* Limit width on mobile */
            }

            .user-email {
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }

            .nav-actions {
                gap: 0.4rem;
            }

            .nav-btn {
                width: 32px;
                height: 32px;
            }

            .nav-btn i {
                font-size: 0.8rem;
            }

            .events-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .event-card {
                height: auto;
            }

            .event-card img {
                height: 180px;
            }

            .event-content {
                padding: 1rem;
            }

            .event-details h3 {
                font-size: 1.1rem;
            }

            .event-header {
                flex-direction: column;
                gap: 0.5rem;
                align-items: flex-start;
            }

            .event-badge {
                padding: 4px 8px;
                font-size: 0.8rem;
            }

            .modal-content {
                width: 95%;
                margin: 1rem;
                padding: 1rem;
                max-height: 90vh;
            }

            .event-images {
                height: 200px;
            }

            .event-info-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .ticket-type-selection {
                flex-direction: column;
            }

            .book-tickets-btn {
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            .navbar h1 {
                font-size: 1.1rem;
            }

            .user-details {
                max-width: 100px;
            }
        }

        /* Touch-friendly improvements */
        @media (hover: none) {
            .book-btn,
            .home-btn,
            .my-tickets-btn,
            .logout-btn {
                -webkit-tap-highlight-color: transparent;
                min-height: 44px;
            }

            .event-card {
                transform: none !important;
            }

            .event-card:active {
                opacity: 0.9;
            }
        }
    

        /* Prevent text overflow */
        .event-details h3,
        .event-details p {
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        /* Improve modal scrolling on mobile */
        .modal-content {
            -webkit-overflow-scrolling: touch;
        }

        /* Loading states for better UX */
        .loading {
            opacity: 0.7;
            pointer-events: none;
        }

        /* Improve form usability on mobile */
        input[type="number"],
        input[type="text"],
        input[type="email"],
        select {
            -webkit-appearance: none;
            appearance: none;
            font-size: 16px; /* Prevents iOS zoom */
        }

        .event-info-list {
            margin-top: 1rem;
        }

        .event-info-list p {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 0.5rem;
            color: #4a5568;
        }

        .event-info-list i {
            width: 16px;
            color: #3B82F6;
        }

        .event-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 1rem;
        }

        .event-header h3 {
            font-size: 1.2rem;
            color: #1a202c;
            margin-bottom: 0.5rem;
        }

        .event-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 500;
            white-space: nowrap;
        }

        /* Add/Update these styles in dashboard.html */
        .tickets-container {
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
}

        .ticket-card {
            background: white;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .ticket-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .ticket-header h3 {
            font-size: 1.25rem;
            font-weight: 600;
            margin: 0;
        }

        .ticket-status {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.875rem;
            background: rgba(255, 255, 255, 0.2);
        }

        .ticket-status.active {
            background: #4CAF50;
        }

        .ticket-status.used {
            background: #9E9E9E;
        }

        .ticket-status.expired {
            background: #F44336;
        }

        .ticket-content {
            padding: 20px;
        }

        .ticket-info {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .ticket-info p {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 0;
            font-size: 1rem;
        }

        .ticket-info i {
            width: 20px;
            color: #667eea;
            font-size: 1.1rem;
        }

        .ticket-info .label {
            color: #64748b;
            min-width: 100px;
        }

        .ticket-info .value {
            color: #1a202c;
            font-weight: 500;
        }

        .ticket-info .value.highlight {
            color: #667eea;
        }

        .ticket-info .value.price {
            color: #059669;
            font-weight: 600;
        }

        .ticket-info .value.mono {
            font-family: monospace;
            color: #4a5568;
            letter-spacing: 0.5px;
        }

        .ticket-actions {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
        }

        .download-btn {
            width: 100%;
            padding: 12px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .download-btn:hover {
            background: #5a67d8;
            transform: translateY(-1px);
        }

        .download-btn i {
            font-size: 1.1rem;
        }

        /* Mobile responsive adjustments */
        @media (max-width: 768px) {
            .ticket-header {
                padding: 15px;
            }

            .ticket-content {
                padding: 15px;
            }

            .ticket-info .label {
                min-width: 80px;
                font-size: 0.9rem;
            }

            .ticket-info .value {
                font-size: 0.9rem;
            }
        }

        /* Loading Animation */
        .tickets-loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
            text-align: center;
        }

        .tickets-loader {
            width: 40px;
            height: 40px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Add to both dashboard.html and event-details.html */
        .nav-actions {
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .nav-btn {
            position: relative;
            width: 38px;
            height: 38px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .nav-btn::after {
            content: attr(title);
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .nav-btn:hover::after {
            opacity: 1;
            visibility: visible;
        }

        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        /* Style for logout button */
        .nav-btn[title="Logout"] {
            background: rgba(239, 68, 68, 0.2);
        }

        .nav-btn[title="Logout"]:hover {
            background: rgba(239, 68, 68, 0.3);
        }

        /* User profile styles */
        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
            padding-right: 1.5rem;
            border-right: 1px solid rgba(255, 255, 255, 0.2);
        }

        .user-profile i {
            font-size: 1.8rem;
            color: rgba(255, 255, 255, 0.9);
        }

        .user-details {
            display: flex;
            flex-direction: column;
            line-height: 1.2;
        }

        .user-name {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.8);
        }

        .user-email {
            font-size: 0.9rem;
            color: white;
        }

        /* Mobile responsive */
        @media (max-width: 768px) {
            .user-profile {
                display: none;
            }

            .nav-actions {
                gap: 0.5rem;
            }

            .nav-btn {
                width: 35px;
                height: 35px;
            }

            .nav-btn i {
                font-size: 0.9rem;
            }
        }

        /* Footer Styles */
        .footer {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin-top: 4rem;
            position: relative;
        }


        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1.5fr 1fr 1fr;
            gap: 3rem;
            padding: 0 2rem;
            position: relative;
        }

        .footer-section h3 {
            color: white;
            margin-bottom: 1.5rem;
            font-size: 1.4rem;
            font-weight: 600;
            position: relative;
            padding-bottom: 10px;
        }

        .footer-section h3::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 50px;
            height: 3px;
            background: #667eea;
            border-radius: 2px;
        }

        .footer-section p {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.8;
            font-size: 0.95rem;
        }

        .footer-section ul {
            list-style: none;
            padding: 0;
        }

        .footer-section ul li {
            margin-bottom: 1rem;
            transition: transform 0.3s ease;
        }

        .footer-section ul li:hover {
            transform: translateX(5px);
        }

        .footer-section ul li a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .footer-section ul li a::before {
            content: '';
            color: #667eea;
            font-weight: bold;
        }

        .footer-section ul li a:hover {
            color: white;
        }

        .social-links {
            display: flex;
            gap: 1.2rem;
            margin-top: 1.5rem;
        }

        .social-links a {
            color: white;
            font-size: 1.5rem;
            transition: all 0.3s ease;
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .social-links a:hover {
            transform: translateY(-5px);
            background: #667eea;
            color: white;
        }

        .footer-bottom {
            text-align: center;
            padding: 1.5rem 0;
            margin-top: 4rem;
            background: rgba(0, 0, 0, 0.2);
            position: relative;
        }

        .footer-bottom p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .footer {
                padding: 3rem 0 0;
            }

            .footer-content {
                grid-template-columns: 1fr;
                gap: 2rem;
                text-align: center;
            }

            .footer-section h3::after {
                left: 50%;
                transform: translateX(-50%);
            }

            .social-links {
                justify-content: center;
            }

            .footer-section ul li a {
                justify-content: center;
            }

            .footer-section ul li:hover {
                transform: translateX(0) translateY(-2px);
            }
        }

        /* Featured Carousel Styles */
        .featured-carousel {
            width: 100%;
            height: 400px; /* Increased height */
            position: relative;
            overflow: hidden;
            background: #f0f2f5; /* Changed from black to match body background */
            margin-bottom: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .carousel-container {
            display: flex;
            transition: transform 0.5s ease;
            height: 100%;
        }

        .carousel-item {
            min-width: 100%;
            height: 100%;
            position: relative;
            flex-shrink: 0;
            background: white; /* Added white background */
        }

        .carousel-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .carousel-content {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 2rem;
            background: linear-gradient(transparent, rgba(0,0,0,0.8));
            color: white;
        }

        .carousel-content h2 {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .carousel-info {
            display: flex;
            gap: 2rem;
            align-items: center;
            font-size: 1rem;
            color: rgba(255,255,255,0.9);
        }

        .carousel-info i {
            color: #667eea;
            margin-right: 0.5rem;
        }

        @media (max-width: 768px) {
            .featured-carousel {
                height: 300px;
            }

            .carousel-content h2 {
                font-size: 1.5rem;
            }

            .carousel-info {
                font-size: 0.9rem;
                gap: 1rem;
            }
        }

        /* Add these styles for the heading section */
        .heading-section {
            text-align: center;
            padding: 2rem 1rem;
            background: linear-gradient(135deg, rgba(102,126,234,0.1) 0%, rgba(118,75,162,0.1) 100%);
            margin-bottom: 2rem;
        }

        .main-heading {
            font-size: 2.5rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
            font-weight: 700;
            text-transform: capitalize;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 768px) {
            .main-heading {
                font-size: 1.8rem;
            }
        }

        /* Minimal Scrollbar Styles */
        ::-webkit-scrollbar {
            width: 5px;  /* Reduced from 8px to 5px */
            height: 5px;
        }

        /* For Firefox */
        * {
            scrollbar-width: thin;
        }

        /* Hide scrollbar for carousel while keeping functionality */
        .carousel-container::-webkit-scrollbar {
            display: none;
        }

        .carousel-container {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }

        /* Optional: Make body scroll smooth */
        html {
            scroll-behavior: smooth;
        }

        /* Add these inside your <style> tag */
        .ticket-card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .download-btn {
            width: 100%;
            padding: 0.8rem;
            margin-top: 1rem;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
        }

        .download-btn:hover {
            background: #5a67d8;
            transform: translateY(-2px);
        }

        .ticket-header {
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #eee;
        }

        .ticket-details {
            display: grid;
            gap: 0.8rem;
        }

        .ticket-status {
            font-weight: 500;
            padding: 0.5rem;
            border-radius: 5px;
            text-align: center;
        }

        .ticket-status.valid {
            background: #e6fffa;
            color: #319795;
        }

        .ticket-status.used {
            background: #e9ecef;
            color: #495057;
        }

        /* Add these styles for ticket cards and modal responsiveness */
        .ticket-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            overflow: hidden;
            transition: transform 0.2s ease;
        }

        .ticket-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .ticket-header {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            padding: 15px 20px;
            position: relative;
        }

        .ticket-title {
            font-size: 18px;
            font-weight: 600;
            margin: 0;
            padding-right: 40px;
        }

        .ticket-date {
            font-size: 14px;
            opacity: 0.9;
            margin-top: 5px;
        }

        .ticket-content {
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .ticket-details {
            flex: 1;
        }

        .ticket-info {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .info-item {
            display: flex;
            flex-direction: column;
        }

        .info-label {
            color: #6b7280;
            font-size: 13px;
            margin-bottom: 4px;
        }

        .info-value {
            color: #1a202c;
            font-size: 15px;
            font-weight: 500;
        }

        .ticket-actions {
            margin-left: 20px;
        }

        .download-btn {
            background: #6366f1;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 500;
            transition: background 0.2s ease;
        }

        .download-btn:hover {
            background: #4f46e5;
        }

        .download-btn i {
            font-size: 16px;
        }

        /* Mobile Styles */
        @media (max-width: 768px) {
            .ticket-card {
                border-radius: 8px;
            }

            .ticket-header {
                padding: 12px 15px;
            }

            .ticket-title {
                font-size: 16px;
                padding-right: 35px;
            }

            .ticket-content {
                padding: 15px;
                flex-direction: column;
                align-items: flex-start;
            }

            .ticket-info {
                grid-template-columns: 1fr;
                gap: 10px;
                width: 100%;
            }

            .info-item {
                flex-direction: row;
                align-items: center;
                justify-content: space-between;
            }

            .info-label {
                font-size: 12px;
                margin-bottom: 0;
            }

            .info-value {
                font-size: 14px;
            }

            .ticket-actions {
                margin-left: 0;
                margin-top: 15px;
                width: 100%;
            }

            .download-btn {
                width: 100%;
                justify-content: center;
                padding: 12px;
            }

            .download-btn span {
                display: none;
            }
        }

        /* Modal Responsive Styles */
        @media (max-width: 768px) {
            .modal-content {
                width: 95%;
                margin: 10px;
                max-height: 90vh;
            }

            #eventFullDetails {
                padding: 15px;
            }

            .ticket-download {
                transform: scale(0.8);
                transform-origin: top center;
            }
        }

        .tickets-modal {
            max-width: 800px;
            width: 90%;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            margin: 2rem auto;
            display: flex;
            flex-direction: column;
            max-height: 85vh;
        }

        .tickets-container {
            padding: 2rem;
            overflow-y: auto;
            flex: 1;
        }

        .tickets-grid {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            max-width: 600px;
            margin: 0 auto;
        }

        .ticket-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            overflow: hidden;
            min-height: 220px;
            flex-shrink: 0;
        }

        /* Custom scrollbar for tickets container */
        .tickets-container::-webkit-scrollbar {
            width: 0.1px;
        }

        .tickets-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        .tickets-container::-webkit-scrollbar-thumb {
            background: #c5c5c5;
            border-radius: 3px;
            transition: background 0.2s ease;
        }

        .tickets-container::-webkit-scrollbar-thumb:hover {
            background: #9ca3af;
        }

        /* For Firefox */
        .tickets-container {
            scrollbar-width: thin;
            scrollbar-color: #c5c5c5 #f1f1f1;
        }

        @media (max-width: 768px) {
            .tickets-modal {
                width: 95%;
                margin: 1rem auto;
                max-height: 90vh;
            }

            .tickets-container {
                padding: 1rem;
            }

            .ticket-card {
                min-height: 200px;
            }
        }

        /* Empty State Styling */
        .tickets-empty {
            text-align: center;
            padding: 3rem 1rem;
            color: #64748b;
        }

        .tickets-empty i {
            font-size: 3rem;
            color: #94a3b8;
            margin-bottom: 1rem;
        }

        .tickets-empty p {
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }

        .tickets-empty .empty-action {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
        }

        .tickets-modal {
            max-width: 800px;
            width: 90%;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            margin: 2rem auto;
            display: flex;
            flex-direction: column;
            max-height: 85vh;
        }

        .tickets-footer {
            padding: 1rem;
            background: #f8fafc;
            border-top: 1px solid #e2e8f0;
        }

        .ticket-note {
            color: #64748b;
            font-size: 0.9rem;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .ticket-note i {
            color: #667eea;
        }
    </style>
</head>
<body>
    <!-- Loader -->
    <div id="loader-wrapper">
        <div class="loader">
            <div class="loader-inner">
                <div class="loader-line-wrap">
                    <div class="loader-line"></div>
                </div>
                <div class="loader-line-wrap">
                    <div class="loader-line"></div>
                </div>
                <div class="loader-line-wrap">
                    <div class="loader-line"></div>
                </div>
                <div class="loader-line-wrap">
                    <div class="loader-line"></div>
                </div>
                <div class="loader-line-wrap">
                    <div class="loader-line"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- First: Navbar -->
    <div class="navbar">
        <h1>EventTix</h1>
        <div class="user-info">
            <div class="user-profile">
                <i class="fas fa-user-circle"></i>
                <div class="user-details">
                    <span class="user-name">Welcome,</span>
                    <span id="userEmail" class="user-email"></span>
                </div>
            </div>
            <div class="nav-actions">
                <a href="index.html" class="nav-btn" title="Dashboard">
                    <i class="fas fa-home"></i>
                </a>
                <button class="nav-btn" title="My Tickets" onclick="viewMyTickets()">
                    <i class="fas fa-ticket-alt"></i>
                </button>
                <button class="nav-btn" title="Logout" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Second: Carousel -->
    <div class="featured-carousel">
        <div class="carousel-container" id="carouselContainer">
            <!-- Events will be dynamically added here -->
        </div>
    </div>

    <!-- Third: Heading Section (after carousel) -->
    <div class="heading-section">
        <h2 class="main-heading" id="dynamicHeading"></h2>
    </div>

    <!-- Fourth: Container -->
    <div class="container">
        <div class="events-grid" id="eventsContainer">
            <!-- Events will be dynamically added here -->
        </div>
    </div>

    <!-- Booking Modal -->
    <div id="bookingModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            
            <!-- Event Details Section -->
            <div id="eventFullDetails" style="display: block;">
                <!-- Will be populated dynamically -->
            </div>

            <!-- Ticket Selection -->
            <div id="ticketSelection" style="display: none;">
                <h3>Book Tickets</h3>
                <div class="form-group">
                    <label>Number of Tickets</label>
                    <input type="number" id="ticketCount" min="1" max="10" value="1">
                </div>
                <button onclick="proceedToPayment()" class="book-btn">Continue to Payment</button>
            </div>

            <!-- Payment Section -->
            <div id="paymentDetails" style="display: none;">
                <h3>Payment Details</h3>
                <div class="form-group">
                    <label>Card Type</label>
                    <select id="cardType" class="form-control">
                        <option value="credit">Credit Card</option>
                        <option value="debit">Debit Card</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Card Number</label>
                    <input type="text" id="cardNumber" placeholder="1234 5678 9012 3456" maxlength="19">
                </div>
                <div class="form-group">
                    <label>Expiry Date</label>
                    <input type="text" id="cardExpiry" placeholder="MM/YY" maxlength="5">
                </div>
                <div class="form-group">
                    <label>CVV</label>
                    <input type="text" id="cardCVV" placeholder="123" maxlength="3">
                </div>
                <div class="form-group">
                    <label>Name on Card</label>
                    <input type="text" id="cardName" placeholder="John Doe">
                </div>
                <button onclick="processPayment()" class="book-btn">Pay Now</button>
            </div>

            <!-- Payment Processing -->
            <div id="paymentProcessing" style="display: none;">
                <div class="payment-processing">
                    <div class="payment-loader"></div>
                    <p>Processing your payment...</p>
                </div>
            </div>

            <!-- Success Section -->
            <div id="successSection" style="display: none;">
                <div id="successMessage"></div>
                <div id="qrcode"></div>
            </div>
        </div>
    </div>

    <!-- My Tickets Modal -->
    <div id="myTicketsModal" class="modal">
        <div class="modal-content tickets-modal">
            <div class="tickets-header">
                <div class="tickets-title">
                    <h2><i class="fas fa-ticket-alt"></i> My Tickets</h2>
                </div>
                <span class="close" onclick="closeMyTicketsModal()">&times;</span>
            </div>
            <div class="tickets-container">
                <div id="ticketsList" class="tickets-grid">
                    <!-- Tickets will be dynamically added here -->
                </div>
            </div>
            <div class="tickets-footer">
                <p class="ticket-note">
                    <i class="fas fa-info-circle"></i>
                    Note: Tickets are automatically removed after the event ends
                </p>
            </div>
        </div>
    </div>

    <!-- Add footer -->
    <footer class="footer">
        <div class="footer-bottom">
            <p>&copy; 2024 EventTix. All rights reserved.</p>
        </div>
    </footer>

    <!-- Firebase Scripts -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { 
            getFirestore, 
            collection, 
            getDocs, 
            addDoc, 
            query, 
            where,
            doc,
            getDoc,
            updateDoc,
            increment,
            deleteDoc
        } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCg7vwuwfN8oWSMagExshHCtMHnxzc7pH0",
            authDomain: "event-ticket-fc753.firebaseapp.com",
            projectId: "event-ticket-fc753",
            storageBucket: "event-ticket-fc753.firebasestorage.app",
            messagingSenderId: "216313948465",
            appId: "1:216313948465:web:4c4b8eb9fbb4257fe6e810",
            measurementId: "G-SGBZK0BYVL"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Define downloadTicket function globally right after Firebase initialization
        window.downloadTicket = async function(ticketId) {
            try {
                // Get ticket data
                const ticketDoc = await getDoc(doc(db, 'tickets', ticketId));
                if (!ticketDoc.exists()) {
                    alert('Ticket not found');
                    return;
                }

                const ticket = ticketDoc.data();

                // Get event data for rules
                const eventDoc = await getDoc(doc(db, 'events', ticket.eventId));
                const eventData = eventDoc.exists() ? eventDoc.data() : null;

                // Create a container div with specific styles
                const containerDiv = document.createElement('div');
                containerDiv.style.position = 'absolute';
                containerDiv.style.top = '0';
                containerDiv.style.left = '0';
                containerDiv.style.width = '1000px';
                containerDiv.style.height = 'auto';
                containerDiv.style.backgroundColor = 'transparent';
                containerDiv.style.zIndex = '-1000';
                containerDiv.style.opacity = '1';
                containerDiv.style.transform = 'none';

                // Generate QR code for the ticket
                const qrCodeUrl = await new Promise((resolve) => {
                    const qr = new QRCode(document.createElement("div"), {
                        text: `${ticket.ticketIdentifier}`,
                        width: 128,
                        height: 128
                    });
                    resolve(qr._el.firstChild.toDataURL());
                });

                // Create ticket content
                containerDiv.innerHTML = `
                    <div style="
                        width: 1200px;
                        padding: 20px;
                        background: transparent;
                        font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
                    ">
                        <div style="
                            width: 100%;
                            background: white;
                            border-radius: 16px;
                            overflow: hidden;
                            border: 1px solid rgba(99, 102, 241, 0.2);
                            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                        ">
                            <!-- Header with gradient -->
                            <div style="
                                background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
                                padding: 15px 30px;
                                color: white;
                                position: relative;
                                display: flex;
                                align-items: center;
                                justify-content: space-between;
                                height: 80px;
                            ">
                                <!-- Left: Ticket ID -->
                                <div style="
                                    background: rgba(255, 255, 255, 0.1);
                                    padding: 8px 16px;
                                    border-radius: 20px;
                                    font-family: monospace;
                                    font-size: 14px;
                                ">${ticket.ticketIdentifier}</div>

                                <!-- Center: EventTix Logo -->
                                <div style="
                                    text-align: center;
                                ">
                                    <div style="
                                        font-size: 42px;
                                        font-weight: bold;
                                        letter-spacing: 1px;
                                        line-height: 1;
                                    ">
                                        <span style="color: #ff4d4d;">Event</span>
                                        <span style="color: white;">Tix</span>
                                    </div>
                                    <div style="
                                        font-size: 14px;
                                        opacity: 0.9;
                                        margin-top: 4px;
                                    ">Official Digital Event Ticket</div>
                                </div>

                                <!-- Right: Empty space for balance -->
                                <div style="width: 150px;"></div>
                            </div>

                            <!-- Event Name -->
                            <div style="
                                text-align: center;
                                padding: 15px;
                                background: white;
                                border-bottom: 1px solid #e2e8f0;
                            ">
                                <h2 style="
                                    font-size: 24px;
                                    color: #1a202c;
                                    margin: 0;
                                "> ${ticket.eventName} </h2>
                            </div>

                            <!-- Main Content Area -->
                            <div style="
                                display: flex;
                                padding: 25px;
                                position: relative;
                                min-height: 180px;
                            ">
                                <!-- Left Section -->
                                <div style="flex: 1; padding-right: 20px;">
                                    <div style="margin-bottom: 12px;">
                                        <div style="color: #4a5568; font-size: 16px; font-weight: 600;">Event Date:</div>
                                        <div style="font-size: 16px;">${new Date(ticket.eventDate).toLocaleDateString()}</div>
                                    </div>

                                    <div style="margin-bottom: 12px;">
                                        <div style="color: #4a5568; font-size: 16px; font-weight: 600;">Venue:</div>
                                        <div style="font-size: 16px;">${ticket.venue || 'Online'}</div>
                                    </div>

                                    <div style="margin-bottom: 12px;">
                                        <div style="color: #4a5568; font-size: 16px; font-weight: 600;">Ticket Type:</div>
                                        <div style="font-size: 16px;">${ticket.ticketType || 'Standard'}</div>
                                    </div>
                                </div>

                                <!-- Center Section -->
                                <div style="flex: 1; padding: 0 20px; border-left: 1px dashed #e2e8f0;">
                                    <div style="margin-bottom: 12px;">
                                        <div style="color: #4a5568; font-size: 16px; font-weight: 600;">Quantity:</div>
                                        <div style="font-size: 24px; color: #4299e1; font-weight: bold;">${ticket.ticketCount} tickets</div>
                                    </div>

                                    <div style="margin-bottom: 12px;">
                                        <div style="color: #4a5568; font-size: 16px; font-weight: 600;">Amount Paid:</div>
                                        <div style="font-size: 16px;">${ticket.totalPrice}</div>
                                    </div>

                                    <div style="margin-bottom: 12px;">
                                        <div style="color: #4a5568; font-size: 16px; font-weight: 600;">Booked By:</div>
                                        <div style="font-size: 16px;">${ticket.userEmail}</div>
                                    </div>
                                </div>

                                <!-- Right Section (QR Code) -->
                                <div style="
                                    width: 200px;
                                    text-align: center;
                                    border-left: 1px dashed #e2e8f0;
                                    padding-left: 20px;
                                ">
                                    <img src="${qrCodeUrl}" style="
                                        width: 150px;
                                        height: 150px;
                                        margin-bottom: 10px;
                                        padding: 8px;
                                        background: white;
                                        border: 1px solid #e2e8f0;
                                        border-radius: 8px;
                                    ">
                                    <div style="
                                        color: #4299e1;
                                        font-size: 14px;
                                        margin-bottom: 5px;
                                    ">Thank you for choosing EventTix!</div>
                                    <div style="
                                        color: #718096;
                                        font-size: 12px;
                                    ">Scan QR code at venue for entry</div>
                                </div>
                            </div>

                            <!-- Terms and Footer Combined -->
                            <div style="
                                background: #f8fafc;
                                border-top: 1px solid #e2e8f0;
                                display: flex;
                                align-items: stretch;
                                min-height: 120px;
                            ">
                                <!-- Terms -->
                                <div style="
                                    flex: 1;
                                    padding: 15px 25px;
                                    display: flex;
                                    flex-direction: column;
                                ">
                                    <div style="
                                        font-weight: 600;
                                        color: #4a5568;
                                        margin-bottom: 8px;
                                    ">Terms and Conditions</div>
                                    <div style="
                                        font-size: 13px;
                                        color: #718096;
                                        overflow-y: auto;
                                        max-height: 120px;
                                        scrollbar-width: thin;
                                        scrollbar-color: #cbd5e0 #f8fafc;
                                        line-height: 1.5;
                                    ">
                                        <div style="padding-right: 10px;">
                                            ${eventData?.rules ? `
                                                ${eventData.rules}
                                            ` : `
                                                 Valid ID proof is mandatory for entry
                                                 Outside food and beverages are not allowed
                                                 No photography or recording without permission
                                                 Entry will be denied if ticket is damaged
                                                 Ticket is non-transferable and non-refundable
                                                 One ticket valid for one person only
                                                 Re-entry may not be permitted
                                                 Organizers reserve the right to deny entry
                                            `}
                                        </div>
                                    </div>
                                </div>

                                <!-- Footer -->
                                <div style="
                                    text-align: right;
                                    padding: 15px 25px;
                                    color: #718096;
                                    font-size: 12px;
                                    border-left: 1px solid #e2e8f0;
                                    display: flex;
                                    flex-direction: column;
                                    justify-content: flex-end;
                                    min-width: 200px;
                                ">
                                    This is an official digital ticket.<br>Valid only with matching ID proof.
                                </div>
                            </div>
                        </div>
                    </div>
                `;

                // Add container to body
                document.body.appendChild(containerDiv);

                // Wait for the next frame to ensure rendering
                await new Promise(resolve => requestAnimationFrame(resolve));

                try {
                    // Capture the ticket
                    const canvas = await html2canvas(containerDiv.firstElementChild, {
                        scale: 2,
                        useCORS: true,
                        allowTaint: true,
                        backgroundColor: 'transparent',
                        logging: true,
                        onclone: function(clonedDoc) {
                            const clonedElement = clonedDoc.querySelector('div');
                            if (clonedElement) {
                                clonedElement.style.transform = 'none';
                                clonedElement.style.opacity = '1';
                            }
                        }
                    });

                    // Convert to image and download
                    const image = canvas.toDataURL('image/png', 1.0);
                    const link = document.createElement('a');
                    link.download = `EventTix-${ticket.ticketIdentifier}.png`;
                    link.href = image;
                    link.click();
                } finally {
                    // Clean up
                    document.body.removeChild(containerDiv);
                }

            } catch (error) {
                console.error('Error downloading ticket:', error);
                alert('Error downloading ticket. Please try again.');
            }
        };

        // Make Firebase instances and functions available globally
        window.auth = auth;
        window.db = db;
        window.collection = collection;
        window.getDocs = getDocs;
        window.addDoc = addDoc;
        window.query = query;
        window.where = where;
        window.signOut = signOut;
        window.doc = doc;
        window.getDoc = getDoc;
        window.updateDoc = updateDoc;
        window.increment = increment;
        window.deleteDoc = deleteDoc;

        // Define the logout function in the module scope
        window.logout = async function() {
            try {
                // First sign out from Firebase
                auth.signOut().then(() => {
                    // Clear all localStorage
                    localStorage.clear();
                    
                    // Use window.location.replace for immediate redirect
                    window.location.replace('index.html');
                    
                    // Prevent back navigation
                    window.history.pushState(null, '', 'index.html');
                    
                    // Additional fallback redirect
                    setTimeout(() => {
                        window.location.href = 'index.html';
                    }, 100);
                }).catch((error) => {
                    console.error("Error signing out:", error);
                    // Force redirect even if there's an error
                    window.location.replace('index.html');
                });
            } catch (error) {
                console.error("Logout error:", error);
                // Force redirect even if there's an error
                window.location.replace('index.html');
            }
        };

        // Add this right after Firebase initialization
        let loaderStartTime = Date.now();
        const minLoaderTime = 500; // Minimum time to show loader in milliseconds

        // Function to hide loader
        function hideLoader() {
            const loader = document.getElementById('loader-wrapper');
            if (loader) {
                const currentTime = Date.now();
                const elapsedTime = currentTime - loaderStartTime;
                
                if (elapsedTime >= minLoaderTime) {
                    loader.style.opacity = '0';
                    setTimeout(() => {
                        loader.style.display = 'none';
                    }, 500);
                } else {
                    // Wait for the remaining time
                    setTimeout(() => {
                        loader.style.opacity = '0';
                        setTimeout(() => {
                            loader.style.display = 'none';
                        }, 500);
                    }, minLoaderTime - elapsedTime);
                }
            }
        }

        // Add this function after Firebase initialization and before the event listeners
        async function loadEvents() {
            console.log("Loading events...");
            const eventsContainer = document.getElementById('eventsContainer');
            eventsContainer.innerHTML = '';

            try {
                const now = new Date();
                const querySnapshot = await getDocs(collection(db, 'events'));
                console.log("Events query response:", querySnapshot.size, "events found");

                if (querySnapshot.empty) {
                    eventsContainer.innerHTML = '<p>No events available.</p>';
                    return;
                }

                querySnapshot.forEach((doc) => {
                    const event = doc.data();
                    
                    // Check if event should be visible based on scheduling
                    if (event.scheduling) {
                        if (event.scheduling.publishDate && new Date(event.scheduling.publishDate) > now) {
                            return; // Skip this event if not published yet
                        }
                        if (event.scheduling.hideDate && new Date(event.scheduling.hideDate) < now) {
                            return; // Skip this event if already hidden
                        }
                    }

                    // Check ticket availability
                    let availableTickets = 0;
                    if (event.eventType === 'hybrid') {
                        availableTickets = (event.tickets?.venue?.available || 0) + (event.tickets?.online?.available || 0);
                    } else {
                        availableTickets = event.availableTickets || 0;
                    }

                    // Check booking period
                    const bookingStart = new Date(event.bookingStartDate);
                    const bookingEnd = new Date(event.bookingDeadline);
                    const isBookingOpen = now >= bookingStart && now <= bookingEnd;

                    // Create event card with all necessary information
                    const eventCard = createEventCard(event, doc.id, isBookingOpen, availableTickets);
                    eventsContainer.appendChild(eventCard);
                });
            } catch (error) {
                console.error("Error loading events:", error);
                eventsContainer.innerHTML = '<p>Error loading events. Please try again.</p>';
            }
        }

        function createEventCard(event, eventId, isBookingOpen, availableTickets) {
            const eventDate = new Date(event.date);
            const formattedDate = eventDate.toLocaleDateString('en-IN', {
                day: 'numeric',
                month: 'long',
                year: 'numeric'
            });

            // Get booking status message
            let bookingStatus = '';
            let buttonText = 'View Details';
            let buttonDisabled = false;

            if (availableTickets <= 0) {
                bookingStatus = '<div class="booking-status error">Sold Out</div>';
                buttonText = 'Sold Out';
                buttonDisabled = true;
            } else if (!isBookingOpen) {
                const bookingStart = new Date(event.bookingStartDate);
                const now = new Date();
                if (now < bookingStart) {
                    bookingStatus = `<div class="booking-status warning">Booking starts on ${bookingStart.toLocaleDateString()} at ${bookingStart.toLocaleTimeString()}</div>`;
                    buttonText = 'Coming Soon';
                } else {
                    bookingStatus = '<div class="booking-status error">Booking closed</div>';
                    buttonText = 'Booking Closed';
                }
                buttonDisabled = true;
            }

            // Create the card HTML
            const div = document.createElement('div');
            div.className = 'event-card';
            div.innerHTML = `
                <div class="event-status-container">
                    ${getEventStatusBadge(event)}
                </div>
                <img src="${event.images?.[0] || 'default-image.jpg'}" alt="${event.name}">
                <div class="event-content">
                    <div class="event-details">
                        <div class="event-header">
                            <h3>${event.name}</h3>
                            ${getEventTypeBadge(event.eventType)}
                        </div>
                        <div class="event-info-list">
                            <p><i class="fas fa-calendar"></i> ${formattedDate}</p>
                            <p><i class="fas fa-map-marker-alt"></i> ${event.eventType === 'online' ? 'Online Event' : event.venueDetails?.venue || 'Venue TBA'}</p>
                            <p><i class="fas fa-ticket-alt"></i> Available: ${availableTickets}</p>
                        </div>
                        ${bookingStatus}
                    </div>
                    <button class="book-btn" onclick="viewEventDetails('${eventId}')" ${buttonDisabled ? 'disabled' : ''}>
                        ${buttonText}
                    </button>
                </div>
            `;

            return div;
        }

        // Add this after Firebase initialization
        const headingQuotes = [
            "Get Your Event Tickets Now! ",
            "Don't Miss Out on Amazing Events! ",
            "Book Your Experience Today! ",
            "Create Memories, Book Events! ",
            "Your Next Adventure Awaits! ",
            "Discover Amazing Events Near You! ",
            "Join the Experience - Book Now! ",
            "Find Your Perfect Event! ",
            "Live, Laugh, Book Events! ",
            "Make It Happen - Book Today! "
        ];

        function updateHeading() {
            const headingElement = document.getElementById('dynamicHeading');
            if (headingElement) {
                const randomIndex = Math.floor(Math.random() * headingQuotes.length);
                headingElement.textContent = headingQuotes[randomIndex];
            }
        }

        // Update the window load event listener to include the heading update
        window.addEventListener('load', function() {
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    document.getElementById('userEmail').textContent = user.email;
                    loadEvents();
                    initializeCarousel();
                    updateHeading(); // Add this line
                    hideLoader();
                } else {
                    window.location.href = 'index.html';
                }
            });
        });

        // Add these helper functions if not already present
        function getEventStatusBadge(event) {
            const now = new Date();
            const eventDate = new Date(event.date);
            const bookingStart = new Date(event.bookingStartDate);
            const bookingEnd = new Date(event.bookingDeadline);

            if (eventDate < now) {
                return '<div class="status-badge closed">EVENT CLOSED</div>';
            }

            if (now < bookingStart) {
                return '<div class="status-badge upcoming">UPCOMING</div>';
            }

            let availableTickets = 0;
            if (event.eventType === 'hybrid') {
                availableTickets = (event.tickets?.venue?.available || 0) + (event.tickets?.online?.available || 0);
            } else {
                availableTickets = event.availableTickets || 0;
            }

            if (availableTickets === 0) {
                return '<div class="status-badge sold-out">SOLD OUT</div>';
            }

            if (now >= bookingStart && now <= bookingEnd) {
                return '<div class="status-badge live">BOOKING LIVE</div>';
            }

            return '<div class="status-badge closed">BOOKING CLOSED</div>';
        }

        function getEventTypeBadge(eventType) {
            const badges = {
                venue: '<span class="event-badge venue">Venue Event</span>',
                online: '<span class="event-badge online">Online Event</span>',
                hybrid: '<span class="event-badge hybrid">Hybrid Event</span>'
            };
            return badges[eventType] || '';
        }

        // Add this function before the window.addEventListener
        async function initializeCarousel() {
            try {
                const querySnapshot = await getDocs(collection(db, 'events'));
                const carouselContainer = document.getElementById('carouselContainer');
                const events = [];

                querySnapshot.forEach((doc) => {
                    const event = doc.data();
                    if (event.images && event.images.length > 0) {
                        // Randomly select an image from the array
                        const randomIndex = Math.floor(Math.random() * event.images.length);
                        events.push({
                            id: doc.id,
                            name: event.name,
                            image: event.images[randomIndex], // Use random image instead of first one
                            date: new Date(event.date).toLocaleDateString('en-IN', {
                                day: 'numeric',
                                month: 'long',
                                year: 'numeric'
                            }),
                            venue: event.eventType === 'online' ? 
                                'Online Event' : 
                                (event.venueDetails?.venue || 'Venue TBA')
                        });
                    }
                });

                if (events.length === 0) {
                    carouselContainer.innerHTML = '<div class="carousel-item"><p style="color: white; text-align: center; padding: 2rem;">No events available</p></div>';
                    return;
                }

                // Create carousel items
                events.forEach((event) => {
                    const item = document.createElement('div');
                    item.className = 'carousel-item';
                    item.innerHTML = `
                        <img src="${event.image}" alt="${event.name}">
                        <div class="carousel-content">
                            <h2>${event.name}</h2>
                            <div class="carousel-info">
                                <span><i class="fas fa-calendar"></i> ${event.date}</span>
                                <span><i class="fas fa-map-marker-alt"></i> ${event.venue}</span>
                            </div>
                        </div>
                    `;
                    item.style.cursor = 'pointer';
                    item.addEventListener('click', () => {
                        window.location.href = `event-details.html?id=${event.id}`;
                    });
                    carouselContainer.appendChild(item);
                });

                // Auto scroll functionality
                let currentIndex = 0;
                const totalItems = events.length;

                function scrollCarousel() {
                    currentIndex = (currentIndex + 1) % totalItems;
                    carouselContainer.style.transform = `translateX(-${currentIndex * 100}%)`;
                }

                // Start auto-scroll if there's more than one event
                if (totalItems > 1) {
                    setInterval(scrollCarousel, 5000);
                }

            } catch (error) {
                console.error('Error initializing carousel:', error);
            }
        }

        // Add this function to handle view details
        async function viewEventDetails(eventId) {
            try {
                const eventDoc = await getDoc(doc(db, 'events', eventId));
                if (!eventDoc.exists()) {
                    alert('Event not found');
                    return;
                }

                const event = eventDoc.data();
                const now = new Date();
                const bookingStart = new Date(event.bookingStartDate);
                const bookingEnd = new Date(event.bookingDeadline);

                // Check ticket availability
                let availableTickets = 0;
                if (event.eventType === 'hybrid') {
                    availableTickets = (event.tickets?.venue?.available || 0) + (event.tickets?.online?.available || 0);
                } else {
                    availableTickets = event.availableTickets || 0;
                }

                // Store booking period info in session storage
                sessionStorage.setItem('eventBookingStart', bookingStart.toISOString());
                sessionStorage.setItem('eventBookingEnd', bookingEnd.toISOString());
                sessionStorage.setItem('availableTickets', availableTickets.toString());

                // If all checks pass, proceed to event details page
                const baseUrl = window.location.pathname.includes('/Event-Ticket-Management') ? '/Event-Ticket-Management' : '';
                window.location.href = `${baseUrl}/event-details.html?id=${eventId}`;

            } catch (error) {
                console.error('Error viewing event details:', error);
                alert('Error loading event details. Please try again.');
            }
        }

        // Make the function globally available
        window.viewEventDetails = viewEventDetails;

        // Add these functions right after Firebase initialization
        window.viewMyTickets = async function() {
            const ticketsModal = document.getElementById('myTicketsModal');
            const ticketsList = document.getElementById('ticketsList');
            ticketsList.innerHTML = '';
            
            try {
                const auth = getAuth();
                const user = auth.currentUser;
                
                if (!user) {
                    console.error('No user logged in');
                    return;
                }

                const now = new Date(); // Get current date/time
                const ticketsRef = collection(db, 'tickets');
                const q = query(ticketsRef, where('userId', '==', user.uid));
                const querySnapshot = await getDocs(q);

                if (querySnapshot.empty) {
                    ticketsList.innerHTML = `
                        <div style="text-align: center; padding: 2rem; color: #666;">
                            <i class="fas fa-ticket-alt" style="font-size: 3rem; color: #ddd; margin-bottom: 1rem;"></i>
                            <p>No tickets found. Book an event to see your tickets here!</p>
                        </div>
                    `;
                } else {
                    const validTickets = [];

                    // Check each ticket's event existence and visibility
                    for (const ticketDoc of querySnapshot.docs) {
                        const ticket = ticketDoc.data();
                        
                        // Check if the event exists and is visible
                        const eventRef = doc(db, 'events', ticket.eventId);
                        const eventDoc = await getDoc(eventRef);
                        
                        if (eventDoc.exists()) {
                            const event = eventDoc.data();
                            let isVisible = true;

                            // Check if event is hidden by scheduler
                            if (event.scheduling) {
                                if (event.scheduling.hideDate && new Date(event.scheduling.hideDate) < now) {
                                    isVisible = false;
                                    // Delete ticket if event is hidden
                                    await deleteDoc(ticketDoc.ref);
                                    continue;
                                }
                            }

                            // Check if event date has passed
                            if (new Date(event.date) < now) {
                                isVisible = false;
                                // Delete ticket if event has ended
                                await deleteDoc(ticketDoc.ref);
                                continue;
                            }

                            if (isVisible) {
                                validTickets.push({
                                    id: ticketDoc.id,
                                    ...ticket
                                });
                            }
                        } else {
                            // Event doesn't exist, delete the ticket
                            await deleteDoc(ticketDoc.ref);
                        }
                    }

                    if (validTickets.length === 0) {
                        ticketsList.innerHTML = `
                            <div style="text-align: center; padding: 2rem; color: #666;">
                                <i class="fas fa-ticket-alt" style="font-size: 3rem; color: #ddd; margin-bottom: 1rem;"></i>
                                <p>No valid tickets found. Book an event to see your tickets here!</p>
                            </div>
                        `;
                    } else {
                        validTickets.forEach(ticket => {
                            const ticketCard = createTicketCard(ticket.id, ticket);
                            ticketsList.appendChild(ticketCard);
                        });
                    }
                }

                ticketsModal.style.display = 'block';
            } catch (error) {
                console.error('Error fetching tickets:', error);
                ticketsList.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #666;">
                        <p>Error loading tickets. Please try again later.</p>
                    </div>
                `;
            }
        };

        // Add this helper function to create ticket cards
        function createTicketCard(ticketId, ticket) {
            const card = document.createElement('div');
            card.className = 'ticket-card';
            
            const eventDate = new Date(ticket.eventDate);
            const formattedDate = eventDate.toLocaleDateString('en-IN', {
                day: 'numeric',
                month: 'long',
                year: 'numeric'
            });
            
            card.innerHTML = `
                <div class="ticket-header">
                    <h3 class="ticket-title">${ticket.eventName}</h3>
                    <div class="ticket-date">
                        <i class="far fa-calendar-alt"></i>
                        ${formattedDate}
                    </div>
                </div>
                <div class="ticket-content">
                    <div class="ticket-info">
                        <div class="info-item">
                            <span class="info-label">
                                <i class="fas fa-map-marker-alt"></i> Venue
                            </span>
                            <span class="info-value">${ticket.venue || 'Online Event'}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">
                                <i class="fas fa-ticket-alt"></i> Quantity
                            </span>
                            <span class="info-value highlight">${ticket.ticketCount} ticket${ticket.ticketCount > 1 ? 's' : ''}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">
                                <i class="fas fa-fingerprint"></i> Ticket ID
                            </span>
                            <span class="info-value">${ticket.ticketIdentifier}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">
                                <i class="fas fa-rupee-sign"></i> Amount Paid
                            </span>
                            <span class="info-value highlight">${ticket.totalPrice}</span>
                        </div>
                    </div>
                    <div class="ticket-actions">
                        <button onclick="downloadTicket('${ticketId}')" class="download-btn" title="Download Ticket">
                            <i class="fas fa-download"></i>
                        </button>
                    </div>
                </div>
            `;
            
            return card;
        }

        // Add this function for ticket filtering
        function filterTickets() {
            const status = document.getElementById('ticketStatusFilter').value;
            const searchText = document.getElementById('ticketSearch').value.toLowerCase();
            const tickets = document.querySelectorAll('.ticket-card');

            tickets.forEach(ticket => {
                const title = ticket.querySelector('.ticket-title').textContent.toLowerCase();
                const isPast = ticket.querySelector('.ticket-status').classList.contains('past');
                
                let statusMatch = status === 'all' || 
                    (status === 'upcoming' && !isPast) || 
                    (status === 'past' && isPast);
                
                let searchMatch = title.includes(searchText);
                
                ticket.style.display = statusMatch && searchMatch ? 'block' : 'none';
            });
        }

        // Add this function to close the tickets modal
        window.closeMyTicketsModal = function() {
            const ticketsModal = document.getElementById('myTicketsModal');
            ticketsModal.style.display = 'none';
        };

        // Add styles to head
        const styleSheet = document.createElement("style");
        styleSheet.textContent = styles;
        document.head.appendChild(styleSheet);

        // Update the nav button click handler
        document.querySelector('.nav-btn[title="My Tickets"]').addEventListener('click', function(e) {
            e.preventDefault();
            viewMyTickets();
        });

        // Add this function to close modal
        function closeModal() {
            const modal = document.getElementById('bookingModal');
            modal.style.display = 'none';
        }

        // Make it globally available
        window.closeModal = closeModal;

        // Add download ticket function
        async function downloadTicket(ticketId) {
            try {
                // Get ticket data
                const ticketDoc = await getDoc(doc(db, 'tickets', ticketId));
                if (!ticketDoc.exists()) {
                    alert('Ticket not found');
                    return;
                }

                const ticket = ticketDoc.data();

                // Create ticket HTML
                const ticketHTML = `
                    <div class="ticket-download">
                        <div class="ticket-header">
                            <h2>EventTix</h2>
                            <p class="ticket-id">ID: ${ticket.ticketIdentifier}</p>
                        </div>
                        <div class="ticket-body">
                            <h3>${ticket.eventName}</h3>
                            <div class="ticket-info">
                                <p><strong>Date:</strong> ${new Date(ticket.eventDate).toLocaleDateString()}</p>
                                <p><strong>Tickets:</strong> ${ticket.ticketCount}</p>
                                <p><strong>Amount Paid:</strong> ${ticket.totalPrice}</p>
                                <p><strong>Status:</strong> ${ticket.used ? 'Used' : 'Valid'}</p>
                            </div>
                        </div>
                        <div class="ticket-footer">
                            <p>This is an electronically generated ticket.</p>
                        </div>
                    </div>
                `;

                // Create a temporary container
                const container = document.createElement('div');
                container.innerHTML = ticketHTML;
                document.body.appendChild(container);

                // Use html2canvas to create image
                const canvas = await html2canvas(container.firstChild);
                document.body.removeChild(container);

                // Convert to image and download
                const image = canvas.toDataURL('image/png');
                const link = document.createElement('a');
                link.download = `EventTix-${ticket.ticketIdentifier}.png`;
                link.href = image;
                link.click();

            } catch (error) {
                console.error('Error downloading ticket:', error);
                alert('Error downloading ticket. Please try again.');
            }
        }

        // Make function globally available
        window.downloadTicket = downloadTicket;

        // Add this right after Firebase initialization and before the event listeners
        function viewMyTickets() {
            const modal = document.getElementById('bookingModal');
            modal.style.display = 'block';
        }

        // Make it globally available
        window.viewMyTickets = viewMyTickets;
    </script>
</body>
</html>
